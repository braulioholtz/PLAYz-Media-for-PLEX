function Menu(){this.PLEX_SESSION_ID="plexSessionID",this.PLEX_PASSWORD_SEQUENCE="plexPasswordSequence",this.PLEX_CURRENT_SECTION="plexCurrentSection",this.PLEX_SERVER_LIST="plexServerList",this.PLEX_CURRENT_PREFIX="plexHomeSelected-",this.PLEX_OPTIONS_PREFIX="plexOptions-",this.currentPasswordSequence=[],this.ischeckinfForPass=!1,this.isSettingPass=!1,this.tmpPassSequence="",this.pressedKeys=[],this.plex=new PLEX,this.cache="",this.toggleActive=!1,this.titleScroll,this.scanErrorCount=0,this.windowHeight=$(window).height(),this.windowWidth=$(window).width();var e=this;window.NetCastSetPageLoadingIcon&&window.NetCastSetPageLoadingIcon("enabled"),window.NetCastSetDefaultAspectRatio&&window.NetCastSetDefaultAspectRatio("original"),localStorage.getItem(this.PLEX_SESSION_ID)&&""!=localStorage.getItem(this.PLEX_SESSION_ID)||localStorage.setItem(this.PLEX_SESSION_ID,this.plex.getSessionID()),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"largeText")&&$("body").addClass("xlarge"),$("#navigator #sections").mousewheel(function(e){$(this).scrollTop($(this).scrollTop()-e.deltaY*e.deltaFactor),e.preventDefault()}),$("#recentlyAdded .content").mousewheel(function(e){$(this).scrollLeft($(this).scrollLeft()-e.deltaY*e.deltaFactor),e.preventDefault()}),$("#query").focus(function(){window.NetCastSystemKeyboardVisible&&window.NetCastSystemKeyboardVisible(!0)}),$("#query").blur(function(){window.NetCastSystemKeyboardVisible&&window.NetCastSystemKeyboardVisible(!1)}),$("#searchForm").submit(function(){window.NetCastSystemKeyboardVisible&&window.NetCastSystemKeyboardVisible(!1)}),$("#server").click(function(){e.serverSelection()}),$(document).keydown(function(t){if(e.pressedKeys[t.which]=!0,e.isResetPasswordSequence())return void(e.pressedKeys=[]);switch(t.which){case 403:case 122:e.plex.panic();break;case 123:e.serverSelection();break;case 461:case 27:e.close();break;default:e.ischeckinfForPass||e.isSettingPass?1536!=t.which&&(e.isSettingPass?e.setPass(t.keyCode):e.isPasswordApproved(t.keyCode)):((404==t.which||123==t.which)&&e.serverSelection(),405==t.which,406==t.which&&e.askforpass())}}),$(document).keyup(function(t){e.pressedKeys[t.which]=!1}),$("#settings").hide(),$("#navigatorSwitch").click(function(){e.toggleMenu()}),$("#previewClose").click(function(){$("#recentlyAdded .content").scrollLeft(0),$("#preview").fadeOut(),$("#navigator #sections a.selected").focus()})}Menu.prototype.serverSelection=function(){var e=this;if(localStorage.getItem(this.PLEX_SERVER_LIST)&&localStorage.getItem(this.PLEX_SERVER_LIST).length>0){var t=localStorage.getItem(this.PLEX_SERVER_LIST).split(",");$("#serverSelect").empty(),$.each(t,function(e,t){var a=t.split("|");$("#serverSelect").append('<a data-key-index="'+e+'"href="#" data-address="'+a[1]+'">'+a[0]+" ("+a[1]+")</a>")}),$("#serverSelect a").hover(function(){$(this).focus()}),$("#serverSelect a").click(function(){e.plex.setServerUrl($(this).data("address")),location.reload()}),$("#serverSelect a").keydown(function(e){{var t=$(this).data("key-index");$(this).parents("#sections, #settings").find("li a[data-key-index='"+(Number(t)-1)+"']"),$(this).parents("#sections, #settings").find("li a[data-key-index='"+(Number(t)+1)+"']")}38==e.which&&(e.preventDefault(),$(this).prev().focus()),40==e.which&&(e.preventDefault(),$(this).next().focus()),(461==e.which||27==e.which)&&(e.preventDefault(),$("#serverSelect").hide(),$("#navigator a.selected").focus())}),$("#serverSelect").show(),$("#serverSelect a:first").focus()}},Menu.prototype.askforpass=function(){this.ischeckinfForPass=!0,this.currentPasswordSequence=[],localStorage.getItem(this.PLEX_PASSWORD_SEQUENCE)&&""!=localStorage.getItem(this.PLEX_PASSWORD_SEQUENCE)?($("#passwordMessage").text("Enter password sequence"),$("#passwordMessage").show()):($("#passwordMessage").text("Password is not set, please enter a combination of 5 blue,yellow,green"),$("#passwordMessage").show(),$("#passwordMessage").fadeOut(2e3),this.ischeckinfForPass=!1,this.isSettingPass=!0)},Menu.prototype.isPasswordApproved=function(e){var t=this.checkPass(e);1==t?(this.plex.setShouldShowHiddenFiles("true"),location.reload()):0==t&&(this.plex.setShouldShowHiddenFiles("false"),location.reload())},Menu.prototype.isResetPasswordSequence=function(){return this.pressedKeys[406]&&this.pressedKeys[403]?($("#passwordMessage").text("Password resetted"),$("#passwordMessage").show(),$("#passwordMessage").fadeOut(1500),localStorage.setItem(this.PLEX_PASSWORD_SEQUENCE,""),!0):!1},Menu.prototype.setPass=function(e){if(this.ischeckinfForPass){var t=this.checkPass(e);1==t?localStorage.setItem(this.PLEX_PASSWORD_SEQUENCE,this.currentPasswordSequence.toString()):0==t&&(this.tmpPassSequence="")}else this.currentPasswordSequence.push(e),5==this.currentPasswordSequence.length&&(this.tmpPassSequence=this.currentPasswordSequence.toString(),this.currentPasswordSequence=[],$("#passwordMessage").text("Please Retype the password"),$("#passwordMessage").show(),this.ischeckinfForPass=!0)},Menu.prototype.checkPass=function(e){var t=this.isSettingPass?this.tmpPassSequence:localStorage.getItem(this.PLEX_PASSWORD_SEQUENCE);return this.currentPasswordSequence.push(e),this.currentPasswordSequence.toString().indexOf(t)>=0?($("#passwordMessage").text("Passsword accepted"),$("#passwordMessage").show(),$("#passwordMessage").fadeOut(1500),this.ischeckinfForPass=!1,this.isSettingPass=!1,1):this.currentPasswordSequence.length>=5?(this.currentPasswordSequence=[],$("#passwordMessage").text("Wrong sequence entered"),$("#passwordMessage").show(),$("#passwordMessage").fadeOut(1500),this.plex.setShouldShowHiddenFiles("false"),this.ischeckinfForPass=!1,this.isSettingPass=!1,0):2},Menu.prototype.initialise=function(e){var t=this,a=this.plex.getServerUrl();t.showLoader("Searching"),$("#passwordMessage").hide(),a&&this.isValidUrl(t.plex.getServerUrl())?t.plex.checkLibraryServerExists(function(a){t.showLoader("Loading"),$("#serverName").text($(a).find("MediaContainer:first").attr("friendlyName")),t.plex.getSections(function(a){var i=0;$("#sections ul").empty(),$(a).find("Directory").each(function(e,a){t.plex.getShouldShowHiddenFiles()?(html='<li><a data-key-index="'+e+'" data-title="'+t.plex.removeHiddenToken($(this).attr("title"))+'" data-key="'+$(this).attr("key")+'" data-section-type="'+$(this).attr("type")+'" data-art="'+t.plex.getTranscodedPath($(this).attr("art"),t.windowWidth,t.windowHeight)+'" href>'+t.plex.removeHiddenToken($(this).attr("title"))+"</a></li>",i=e,$("#sections ul").append(html)):t.plex.isMarkedAsHidden(a,"title")||(html='<li><a data-key-index="'+e+'" data-title="'+$(this).attr("title")+'" data-key="'+$(this).attr("key")+'" data-section-type="'+$(this).attr("type")+'" data-art="'+t.plex.getTranscodedPath($(this).attr("art"),t.windowWidth,t.windowHeight)+'" href>'+$(this).attr("title")+"</a></li>",i=e,$("#sections ul").append(html))}),$("#sections ul").append('<li><a data-key-index="'+ ++i+'" data-title="playlists" data-key="playlists" data-section-type="playlists" data-art="'+t.plex.getTranscodedPath("/:/resources/movie-fanart.jpg",t.windowWidth,t.windowHeight)+'" href>Playlists</a></li>'),$("#sections ul").append('<li><a data-key-index="'+ ++i+'" data-title="ondeck" data-key="ondeck" data-section-type="ondeck" data-art="'+t.plex.getTranscodedPath("/:/resources/movie-fanart.jpg",t.windowWidth,t.windowHeight)+'" href>'+settings.language.sectionOnDeck+"</a></li>"),$("#sections ul").append('<li><a data-key-index="'+ ++i+'" data-title="search" data-key="search" data-section-type="search" data-art="'+t.plex.getTranscodedPath("/:/resources/movie-fanart.jpg",t.windowWidth,t.windowHeight)+'" href>'+settings.language.sectionSearch+"</a></li>"),$("#navigator #sections li a, #settings li a").off(),$("#navigator #sections li a, #settings li a").focus(function(){var a=this;if(!$(this).hasClass("selected")){$(this).parents("#sections, #settings").find("li a").removeClass("selected"),$(".dialog").hide(),$("#recentlyAdded").removeClass("show-quick-menu"),$("#recentlyAdded").hide(),$(this).addClass("selected");{setTimeout(function(){$(a).hasClass("selected")&&$.event.trigger({type:"navigationFocus",title:$(a).data("title"),key:$(a).data("key"),sectionType:t.plex.getMediaType($(a).data("title"),$(a).data("sectionType")),art:$(a).data("art")})},500)}}}),$("#navigator #sections li a, #settings li a").hover(function(){$(this).focus()}),$("#navigator #sections li a, #navigator #settings li a").click(function(e){$.event.trigger({type:"navigationClick",title:$(this).data("title"),key:$(this).data("key"),sectionType:t.plex.getMediaType($(this).data("title"),$(this).data("sectionType")),art:$(this).data("art")}),e.preventDefault()}),$("#sections a, #settings a").keydown(function(e){var a=$(this).data("key-index"),i=$(this).parents("#sections, #settings").find("li a[data-key-index='"+(Number(a)-1)+"']"),s=$(this).parents("#sections, #settings").find("li a[data-key-index='"+(Number(a)+1)+"']");38==e.which&&(e.preventDefault(),0==Number(a)&&t.serverSelection(),i.focus()),40==e.which&&(e.preventDefault(),s.focus()),37==e.which&&(e.preventDefault(),t.toggleMenu()),39==e.which&&(e.preventDefault(),$.event.trigger({type:"navigationQuickSelect",title:$(this).data("title"),key:$(this).data("key"),sectionType:t.plex.getMediaType($(this).data("title"),$(this).data("sectionType")),art:$(this).data("art")}))}),t.setClock(),t.hideLoader(),e?$(e).focus():localStorage.getItem(t.PLEX_CURRENT_SECTION)&&$("#sections li a[data-key='"+localStorage.getItem(t.PLEX_CURRENT_SECTION)+"']:first").length>0?$("#sections li a[data-key='"+localStorage.getItem(t.PLEX_CURRENT_SECTION)+"']:first").focus():$("#sections li a:first").focus()}),$(document).on("navigationQuickSelect",function(e){switch(e.sectionType){case"settings":$("#scan").focus();break;case"search":$("#query").focus();break;case"options":$("#optionTimeDisplay").focus();break;case"playlists":break;default:localStorage.setItem(t.PLEX_CURRENT_SECTION,e.key),$("#recentlyAdded").hasClass("show-quick-menu")&&$("#recentlyAdded a:first").focus()}}),$(document).on("navigationClick",function(e){switch(e.sectionType){case"quit":t.close();break;case"home":case"movie":case"photo":case"show":case"artist":case"channels":case"playlists":t.showLoader("Loading"),location.href="media.html?action=view&section="+e.sectionType+"&key="+e.key}}),$(document).on("navigationFocus",function(e){switch(e.art&&$("#applicationWallpaper").css("background-image","url("+e.art+")"),e.sectionType){case"search":t.quickSearchMenu(e);break;case"settings":t.settingsDialog();break;case"options":t.optionsDialog();break;case"about":$("#about").show();break;case"help":$("#help").show();break;case"home":case"movie":case"photo":case"show":case"artist":case"ondeck":case"channels":case"playlists":localStorage.setItem(t.PLEX_CURRENT_SECTION,e.key),t.quickSelectionMenu(e)}})},function(){t.hideLoader(),t.settingsDialog(!0),$("#settingsMessage").show(),$("#settingsMessage").html(settings.language.dialogSettingsAddressNotFoundMessage),$("#settingsMessage").fadeOut(5e3)}):(t.hideLoader(),this.settingsDialog(!0),$("#settingsMessage").show(),$("#settingsMessage").html(settings.language.dialogSettingsValidMessage),$("#settingsMessage").fadeOut(5e3))},Menu.prototype.quickSearchMenu=function(){$("#search").fadeIn(),$("#search input, #search button").keydown(function(e){38==e.which&&$(this).data("keyUp")&&($($(this).data("keyUp")).focus(),e.preventDefault()),40==e.which&&$(this).data("keyDown")&&($($(this).data("keyDown")).focus(),e.preventDefault()),37==e.which&&$(this).data("keyLeft")&&($($(this).data("keyLeft")).focus(),e.preventDefault()),39==e.which&&$(this).data("keyRight")&&($($(this).data("keyRight")).focus(),e.preventDefault()),(461==e.which||27==e.which)&&($("#navigator a.selected").focus(),window.NetCastSystemKeyboardVisible(!1),e.preventDefault(),e.stopPropagation())})},Menu.prototype.quickSelectionMenu=function(e){var t=this,a=30,i={start:0,size:a};"playlists"!=e.sectionType&&t.showLoader("Loading"),t.plex.getMediaItems(e.sectionType,e.key,function(i){var s=e.sectionType,n=e.key;this.cache=i;$("#recentlyAdded .content ul").empty(),$(i).find("Directory,Video,Photo").each(function(e,i){(t.plex.getShouldShowHiddenFiles()||!t.plex.isMarkedAsHidden(i,"title"))&&a>e&&(html=t.plex.getThumbHtml(e,t.plex.removeHiddenToken($(this).attr("title")),s+" recent",$(this).attr("type"),$(this).attr("key"),{thumb:$(this).attr("thumb"),parentThumb:$(this).attr("parentThumb"),grandparentThumb:$(this).attr("grandparentThumb"),art:$(this).attr("art"),artist:$(this).attr("parentTitle"),series:$(this).attr("grandparentTitle"),season:$(this).attr("parentIndex"),episode:$(this).attr("index"),parentKey:$(this).attr("parentKey"),lastViewedAt:$(this).attr("lastViewedAt"),viewOffset:$(this).attr("viewOffset"),duration:$(this).attr("duration"),viewCount:$(this).attr("viewCount"),media:$(this).find("Media Part:first").attr("key"),sectionKey:$(this).attr("librarySectionID")?$(this).attr("librarySectionID"):n}),$("#recentlyAdded .content ul").append(html))}),html&&($("#recentlyAdded").attr("data-current-key",e.key),$("#recentlyAdded").show(),$("#recentlyAdded").addClass("show-quick-menu"),$("#recentlyAdded .name").html("channels"==s?settings.language.sectionChannels:settings.language.menuRecentlyAdded),$("#recentlyAdded a").hover(function(){$(this).focus()}),$("#recentlyAdded a").click(function(e){e.preventDefault(),t.showLoader("Loading"),url="./item.html?action=preview&section="+s+"&sectionKey="+n+"&key="+encodeURIComponent($(this).data("key")),$(this).attr("href",url),location.href=url}),$("#recentlyAdded a").focus(function(){{var a=this;$(this)}switch(localStorage.setItem(t.PLEX_CURRENT_PREFIX+$(this).data("sectionType"),$(this).data("key")),$(this).data("mediaType")){case"album":t.plex.getMediaMetadata($(this).data("key"),function(e){var i=$(e).find("MediaContainer:first"),s=[];$(i).find("Track").each(function(){s.push($(this).attr("index")+". "+$(this).attr("title"))}),$("#recentlyAdded a:focus").data("key")==$(a).data("key")&&($("#previewContent").html(t.plex.getMediaHtml(i.attr("title2"),"album",{art:i.attr("art"),thumb:i.attr("thumb"),artist:i.attr("title1"),year:i.attr("parentYear"),tracks:s})),$("#preview").fadeIn())});break;case"episode":t.plex.getMediaMetadata($(this).data("key"),function(e){var i=$(e).find("Video:first");$("#recentlyAdded a:focus").data("key")==$(a).data("key")&&($("#previewContent").html(t.plex.getMediaHtml(i.attr("title"),i.attr("type"),{art:i.attr("art"),thumb:i.attr("thumb"),lastViewedAt:i.attr("lastViewedAt"),viewOffset:i.attr("viewOffset"),viewCount:i.attr("viewCount"),duration:i.attr("duration"),parentThumb:i.attr("parentThumb"),summary:i.attr("summary"),grandparentTitle:i.attr("grandparentTitle"),index:i.attr("index"),parentIndex:i.attr("parentIndex"),contentRating:i.attr("contentRating"),rating:i.attr("rating"),year:i.attr("year")})),$("#preview").fadeIn())});break;case"movie":t.plex.getMediaMetadata($(this).data("key"),function(e){var i=$(e).find("Video:first"),s=[];$(i).find("Role").each(function(){s.push($(this).attr("tag"))});var n=[];$(i).find("Genre").each(function(){n.push($(this).attr("tag"))}),$("#recentlyAdded a:focus").data("key")==$(a).data("key")&&($("#previewContent").html(t.plex.getMediaHtml(i.attr("title"),i.attr("type"),{art:i.attr("art"),thumb:i.attr("thumb"),lastViewedAt:i.attr("lastViewedAt"),viewOffset:i.attr("viewOffset"),viewCount:i.attr("viewCount"),tagline:i.attr("tagline"),summary:i.attr("summary"),studio:i.attr("studio"),year:i.attr("year"),rating:i.attr("rating"),contentRating:i.attr("contentRating"),director:$(i).find("Director:first").attr("tag"),roles:s,genre:n,duration:i.attr("duration")})),$("#preview").fadeIn())});break;case"photo":t.plex.getMediaMetadata($(this).data("key"),function(e){var i=$(e).find("Photo:first");$("#recentlyAdded a:focus").data("key")==$(a).data("key")&&($("#previewContent").html(t.plex.getMediaHtml(i.attr("title"),i.attr("type"),{art:i.attr("art"),thumb:i.attr("thumb"),summary:i.attr("summary"),year:i.attr("year"),width:i.find("Media:first").attr("width"),height:i.find("Media:first").attr("height"),container:i.find("Media:first").attr("container")})),$("#preview").fadeIn())});break;case"channel":break;default:t.plex.getMediaMetadata($(this).data("key"),function(e){var i=$(e).find("Directory:first,Video:first,Photo:first,Track:first");$("#recentlyAdded a:focus").data("key")==$(a).data("key")&&($("#previewContent").html(t.plex.getMediaHtml(i.attr("title"),i.attr("type"),{art:i.attr("art"),thumb:i.attr("thumb"),summary:i.attr("summary"),year:i.attr("year")})),$("#preview").fadeIn())})}}),$("#recentlyAdded a").keydown(function(e){var a=$(this).data("key-index"),i=$(this).parents(".content").find("ul li a[data-key-index='"+(Number(a)-1)+"']"),s=$(this).parents(".content").find("ul li a[data-key-index='"+(Number(a)+1)+"']"),n=$(this).parents(".content").find("ul li").length;37==e.which&&(e.preventDefault(),0==a&&($("#recentlyAdded .content").scrollLeft(0),$("#preview").fadeOut(),$("#navigator #sections a.selected").focus()),n-3>a&&$("#recentlyAdded .content").scrollLeft(142*(a-2)-142),i.focus()),39==e.which&&(e.preventDefault(),a>=2&&$("#recentlyAdded .content").scrollLeft(142*a-142),s.focus()),(415==e.which||80==e.which)&&(e.preventDefault(),$(this).data("media")&&"undefined"!=$(this).data("media")&&(t.showLoader("Loading"),location.href="player.html?key="+$(this).data("key")+"&autoplay=true")),(461==e.which||27==e.which)&&(e.preventDefault(),$("#recentlyAdded .content").scrollLeft(0),$("#preview").fadeOut(),$("#navigator #sections a.selected").focus())}),$(".thumb").lazyload({threshold:400,placeholder:"system/images/poster.png",container:$("#recentlyAdded .content")}),t.hideLoader())},i)},Menu.prototype.setCheckOption=function(e,t){var a=$(e).find("i");a.hasClass("unchecked")?(a.removeClass("unchecked"),a.addClass("check"),localStorage.setItem(t,"1")):(a.removeClass("check"),a.addClass("unchecked"),localStorage.setItem(t,"0"))},Menu.prototype.optionsDialog=function(){var t=this;"0"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"enableTranscoding")&&($("#options a#optionTranscoding i").removeClass("unchecked"),$("#options a#optionTranscoding i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"standalonePlayer")&&($("#options a#optionStandalonePlayer i").removeClass("unchecked"),$("#options a#optionStandalonePlayer i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"time24")&&($("#options a#optionTimeDisplay i").removeClass("unchecked"),$("#options a#optionTimeDisplay i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&($("#options a#optionTitleOverlays i").removeClass("unchecked"),$("#options a#optionTitleOverlays i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"themeMusic")&&($("#options a#optionNoThemeMusic i").removeClass("unchecked"),$("#options a#optionNoThemeMusic i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"nextEpisode")&&($("#options a#optionDisableNextEpisodePlay i").removeClass("unchecked"),$("#options a#optionDisableNextEpisodePlay i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"hoverBackdrop")&&($("#options a#optionBackdropHover i").removeClass("unchecked"),$("#options a#optionBackdropHover i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&($("#options a#optionDisableWatchedIcons i").removeClass("unchecked"),$("#options a#optionDisableWatchedIcons i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"largeText")&&($("#options a#optionLargeText i").removeClass("unchecked"),$("#options a#optionLargeText i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"seekSmall")&&($("#options a#optionSeekSmall i").removeClass("unchecked"),$("#options a#optionSeekSmall i").addClass("check"));var a=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"seekSmallCustom");""==a||isNaN(a)||$("#options input#optionSeekSmallCustom").val(Math.round(a)||""),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"debug")&&($("#options a#optionDebugDetails i").removeClass("unchecked"),$("#options a#optionDebugDetails i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"smallPicutres")&&($("#options a#optionSmallPictures i").removeClass("unchecked"),$("#options a#optionSmallPictures i").addClass("check")),"1"==localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"allItems")&&($("#options a#optionAllItems i").removeClass("unchecked"),$("#options a#optionAllItems i").addClass("check")),$("#options").show(),$("#options a").off(),$("#options a").hover(function(){$(this).focus()}),$("#options a#optionTranscoding").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"enableTranscoding")}),$("#options a#optionStandalonePlayer").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"standalonePlayer")}),$("#options a#optionTimeDisplay").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"time24")}),$("#options a#optionTitleOverlays").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"titleOverlay")}),$("#options a#optionNoThemeMusic").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"themeMusic")}),$("#options a#optionDisableNextEpisodePlay").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"nextEpisode")}),$("#options a#optionBackdropHover").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"hoverBackdrop")}),$("#options a#optionDisableWatchedIcons").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"watchedIcons")}),$("#options a#optionLargeText").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"largeText"),"1"==localStorage.getItem(t.PLEX_OPTIONS_PREFIX+"largeText")?$("body").addClass("xlarge"):$("body").removeClass("xlarge")}),$("#options a#optionSeekSmall").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"seekSmall")}),$("#options input#optionSeekSmallCustom").keydown(function(e){var t=$(this).val()||0;38==e.which&&(t>=600?t=600:t++,$(this).val(t),e.preventDefault()),40==e.which&&(1>=t?t=1:t--,$(this).val(t),e.preventDefault())}),$("#options input#optionSeekSmallCustom").blur(function(e){e.preventDefault(),localStorage.setItem(t.PLEX_OPTIONS_PREFIX+"seekSmallCustom",$(this).val()),"1"!=localStorage.getItem(t.PLEX_OPTIONS_PREFIX+"seekSmall")&&$(this).val()&&$("#options a#optionSeekSmall").click()}),$("#options a#optionDebugDetails").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"debug")}),$("#options a#optionSmallPictures").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"smallPicutres")}),$("#options a#optionAllItems").click(function(e){e.preventDefault(),t.setCheckOption(this,t.PLEX_OPTIONS_PREFIX+"allItems")}),$("#options a, #options input, #options button").keydown(function(e){38==e.which&&$(this).data("keyUp")&&($($(this).data("keyUp")).focus(),e.preventDefault()),40==e.which&&$(this).data("keyDown")&&($($(this).data("keyDown")).focus(),e.preventDefault()),37==e.which&&$(this).data("keyLeft")&&($($(this).data("keyLeft")).focus(),e.preventDefault()),39==e.which&&$(this).data("keyRight")&&($($(this).data("keyRight")).focus(),e.preventDefault()),(461==e.which||27==e.which)&&($("#navigator a.selected").focus(),e.preventDefault(),e.stopPropagation())}),$("#seekSmallClear").click(function(){$("#options input#optionSeekSmallCustom").val(""),$("#options input#optionSeekSmallCustom").focus()})},Menu.prototype.toggleMenu=function(){var e=this;this.toggleActive||(this.toggleActive=!0,$("#navigator a.selected").addClass("return"),$("#navigator a.selected").removeClass("selected"),$("#navigator").hasClass("flip")?($("#sections").show(),$("#navigator").removeClass("flip"),$("#settings").fadeOut(600,function(){$("#sections a").hasClass("return")?($("#sections a.return").focus(),$("#sections a.return").removeClass("return")):$("#sections a:first").focus(),e.toggleActive=!1})):($("#settings").show(),$("#navigator").addClass("flip"),$("#sections").fadeOut(600,function(){$("#settings a.return").focus(),$("#settings a.return").removeClass("return"),e.toggleActive=!1})))},Menu.prototype.settingsDialog=function(e){var t=this,a=document.getElementById("device"),i=a.net_ipAddress,s=new Array;$("#config").fadeIn(400,function(){e&&$("#scan").focus()}),$("#settingsMessage").html("");var n=this.plex.getServerUrl();n&&$("#pms").val(n.substr(n.indexOf("://")+3)),$("#save").off(),$("#scan").off(),$("#save").click(function(){event.preventDefault();var e=$("#pms").val();return e.indexOf("http")>-1?($("#settingsMessage").show(),$("#settingsMessage").html(settings.language.dialogSettingsRemoveMessage),$("#settingsMessage").fadeOut(5e3),!1):(-1==e.indexOf(":")&&(e+=":32400"),t.plex.setServerUrl("http://"+e),void location.reload())}),$("#scan").click(function(){event.preventDefault(),t.scanErrorCount=0,t.scanFoundCount=0,i||(i="10.0.0.1"),t.showLoader("Scanning"),$("#settingsMessage").html(""),$("#settingsMessage").show(),t.plex.scanNetwork(i,function(e){t.scanFoundCount++,$("#pms").val(this.url.substr(this.url.indexOf("://")+3)),s.push($(e).find("MediaContainer:first").attr("friendlyName")+"|"+this.url),$("#settingsMessage").html(settings.language.dialogSettingsFoundMessage+this.url+" "+$(e).find("MediaContainer:first").attr("friendlyName")),$("#settingsMessage").fadeOut(3e3),t.showLoader("PMS found")},function(){t.scanErrorCount++,t.scanErrorCount>=255&&($("#settingsMessage").html(settings.language.dialogSettingsNotFoundMessage),$("#settingsMessage").fadeOut(3e3),t.showLoader("Error"))},function(){localStorage.setItem(t.PLEX_SERVER_LIST,s.unique().join(",")),s.unique().length>1&&($("#settingsMessage").html(settings.language.dialogSettingsMultipleMessage),$("#settingsMessage").fadeOut(3e3)),t.hideLoader()})}),$("#config .keypad").click(function(e){var t=$(this).text(),i=($("#pms").val(),$("#pms").caret());switch($(this).attr("id")){case"kcl":$("#pms").val("");break;case"kb":if(i>0){var s=$("#pms").val().split("");s.splice(i-1,1),$("#pms").val(s.join("")),$("#pms").caret(i-1),$("#kb").focus()}break;default:var s=$("#pms").val().split("");s.splice(i,0,t),$("#pms").val(s.join("")),$("#pms").caret(i+1),$(this).focus()}e.preventDefault()}),$("#config input, #config button").keydown(function(e){38==e.which&&$(this).data("keyUp")&&($($(this).data("keyUp")).focus(),e.preventDefault()),40==e.which&&$(this).data("keyDown")&&($($(this).data("keyDown")).focus(),e.preventDefault()),37==e.which&&$(this).data("keyLeft")&&$($(this).data("keyLeft")).focus(),39==e.which&&$(this).data("keyRight")&&$($(this).data("keyRight")).focus(),(461==e.which||27==e.which)&&($("#navigator a.selected").focus(),e.preventDefault(),e.stopPropagation())}),e&&$("#scan").focus()},Menu.prototype.setClock=function(){var e=this;try{var a=(document.getElementById("device"),new Date);$("#clock").text(a.toLocaleTimeString(navigator.language,{hour:"2-digit",minute:"2-digit",second:"2-digit"})),e.debug&&window.NetCastGetUsedMemorySize&&$("#debugMemory").text(window.NetCastGetUsedMemorySize())}catch(i){var a=new Date;$("#clock").text(a.toLocaleTimeString())}clock=setTimeout(function(){e.setClock()},500)},Menu.prototype.showLoader=function(e){$("#message").text(e),$("#loader").show()},Menu.prototype.hideLoader=function(){$("#loader").hide()},Menu.prototype.close=function(){this.plex.setShouldShowHiddenFiles("false"),window.NetCastExit?window.NetCastBack():window.close()},Menu.prototype.isValidUrl=function(e){if(e.length<14)return!1;var t=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return t.test(e)},Array.prototype.unique=function(){var t,e={},a=this.length,i=[];for(t=0;a>t;t+=1)e[this[t]]=this[t];for(t in e)i.push(e[t]);return i};