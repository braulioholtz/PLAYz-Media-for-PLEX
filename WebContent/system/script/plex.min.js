function PLEX(){this.PLEX_SESSION_ID="plexSessionID",this.LG_PLEX_SERVER="plexServerUrl",this.PLEX_OPTIONS_PREFIX="plexOptions-",this.PLEX_CACHE="cache:",this.PLEX_SHOW_HIDDEN_FILES="plexHiddenFiles",this.X_Plex_Client_Identifier=localStorage.getItem(this.PLEX_SESSION_ID),this.X_Plex_Product="Web%20Client",this.X_Plex_Device="Mac",this.X_Plex_Platform="Chrome",this.X_Plex_Platform_Version="7",this.X_Plex_Version="1.2.12",this.X_Plex_Device_Name="Plex%2FWeb%20(Chrome)";var e=new Date;this.time=e.getTime()}PLEX.prototype.getShouldShowHiddenFiles=function(){return localStorage.getItem(this.PLEX_SHOW_HIDDEN_FILES)&&""!=localStorage.getItem(this.PLEX_SHOW_HIDDEN_FILES)?"true"==localStorage.getItem(this.PLEX_SHOW_HIDDEN_FILES)?!0:!1:(this.setShouldShowHiddenFiles("false"),!1)},PLEX.prototype.setShouldShowHiddenFiles=function(e){localStorage.setItem(this.PLEX_SHOW_HIDDEN_FILES,e)},PLEX.prototype.isMarkedAsHidden=function(e,t){return 0!=$(e).attr(t).length?-1!=$(e).attr(t).indexOf("[p]")||-1!=$(e).attr(t).indexOf("[P]"):!1},PLEX.prototype.setServerUrl=function(e){localStorage.setItem(this.LG_PLEX_SERVER,e)},PLEX.prototype.getServerUrl=function(){return localStorage.getItem(this.LG_PLEX_SERVER)},PLEX.prototype.getServerPort=function(){return localStorage.getItem(this.LG_PLEX_SERVER).substr(localStorage.getItem(this.LG_PLEX_SERVER).lastIndexOf(":")+1)},PLEX.prototype.removeServerUrl=function(){localStorage.removeItem(this.LG_PLEX_SERVER)},PLEX.prototype.getLibraryServer=function(e){$.get(this.getServerUrl(),e)},PLEX.prototype.checkLibraryServerExists=function(e,t){$.ajax({url:this.getServerUrl(),success:e,error:t,timeout:2e4})},PLEX.prototype.scanNetwork=function(e,t,a,r){var s="";for(i=0;255>=i;i++)s="http://"+e.substr(0,e.lastIndexOf(".")+1)+i.toString()+":32400",$.ajax({url:s,success:t,error:a,complete:r,timeout:2e4})},PLEX.prototype.getMediaType=function(e,t){switch(t){case"movie":if(e.indexOf("Home")>-1)return"home"}return t},PLEX.prototype.getPlaylists=function(e){$.get(this.getServerUrl()+"/playlists/all",e)},PLEX.prototype.removeHiddenToken=function(e){return e.replace("[p]","").replace("[P]","")},PLEX.prototype.isTreeContainsHiddenFiles=function(e,t){var i=!1,a=this;if("search"==t)$.ajax({type:"GET",url:a.getServerUrl()+$(e).attr("key"),dataType:"xml",async:!1,success:function(e){$(e).find("MediaContainer").each(function(e,t){return i=a.isMarkedAsHidden(t,"librarySectionTitle"),i?!0:void 0})}});else{if("playlist"!=$(e).attr("type"))return!1;$.ajax({type:"GET",url:a.getServerUrl()+$(e).attr("key"),dataType:"xml",async:!1,success:function(e){$(e).find("Video").each(function(e,t){i||(i="bla3",$.ajax({type:"GET",url:a.getServerUrl()+$(t).attr("key"),dataType:"xml",async:!1,success:function(e){$(e).find("MediaContainer").each(function(e,t){return i=a.isMarkedAsHidden(t,"librarySectionTitle"),i?!0:void 0}),i||$(e).find("Video").each(function(e,t){return i=a.isMarkedAsHidden(t,"title"),i?!0:void 0})}}))})}})}return i},PLEX.prototype.getSections=function(e){$.get(this.getServerUrl()+"/library/sections",e)},PLEX.prototype.getSectionDetails=function(e,t){$.get(this.getServerUrl()+"/library/sections/"+e,t)},PLEX.prototype.getSectionMedia=function(e,t,i,a,r,s){var o=("callback"+(new Date).getTime(),this),l="";s=s||{};s.start||-1,s.size||-1;if("undefined"!=typeof s.start&"undefined"!=typeof s.size&&(l="&X-Plex-Container-Start="+s.start+"&X-Plex-Container-Size="+s.size),a)switch(i){case"folder":case"all":i=decodeURIComponent(a),i.indexOf("?")>-1?$.get(this.getServerUrl()+i+"&X-Plex-Access-Time="+this.time+l,r):$.get(this.getServerUrl()+i+"?X-Plex-Access-Time="+this.time+l,r);break;case"search":$.get(this.getServerUrl()+"/search?query="+a+l,r);break;default:$.get(this.getServerUrl()+"/library/sections/"+t+"/"+i+"/"+a+"?X-Plex-Access-Time="+this.time+l,r)}else switch(e){case"channels":"channels"==t?o.getChannels(t,r):$.get(this.getServerUrl()+t,r);break;case"playlists":"playlists"==t?o.getPlaylists(r):$.get(this.getServerUrl()+"/playlists/"+t+"/items/",r);break;default:$.get(this.getServerUrl()+"/library/sections/"+t+"/"+i+"?X-Plex-Access-Time="+this.time+l,r)}},PLEX.prototype.getRecentlyAdded=function(e,t){$.get(this.getServerUrl()+"/library/sections/"+e+"/recentlyAdded?X-Plex-Container-Start=0&X-Plex-Container-Size=25",t)},PLEX.prototype.getOnDeck=function(e,t){$.get(this.getServerUrl()+"/library/onDeck?X-Plex-Container-Start=0&X-Plex-Container-Size=25",t)},PLEX.prototype.getChannels=function(e,t){$.get(this.getServerUrl()+"/channels/all",t)},PLEX.prototype.getMediaItems=function(e,t,i){switch(e){case"ondeck":this.getOnDeck(t,i);break;case"channels":this.getChannels(t,i);break;case"playlists":break;default:this.getRecentlyAdded(t,i)}},PLEX.prototype.getMediaMetadata=function(e,t){e.indexOf("?")>-1?$.get(this.getServerUrl()+e+"&X-Plex-Access-Time="+this.time,t):$.get(this.getServerUrl()+e+"?X-Plex-Access-Time="+this.time,t)},PLEX.prototype.reportProgress=function(e,t,i){$.get(this.getServerUrl()+"/:/progress?key="+e+"&identifier=com.plexapp.plugins.library&time="+Math.round(i)+"&state="+t,null)},PLEX.prototype.setWatched=function(e,t){$.get(this.getServerUrl()+"/:/scrobble?key="+e+"&identifier=com.plexapp.plugins.library",t)},PLEX.prototype.setUnwatched=function(e,t){$.get(this.getServerUrl()+"/:/unscrobble?key="+e+"&identifier=com.plexapp.plugins.library",t)},PLEX.prototype.setAudioStream=function(e,t){$.ajax({type:"PUT",url:this.getServerUrl()+"/library/parts/"+e+"?audioStreamID="+t})},PLEX.prototype.setSubtitleStream=function(e,t){$.ajax({type:"PUT",url:this.getServerUrl()+"/library/parts/"+e+"?subtitleStreamID="+t})},PLEX.prototype.getTranscodedPath=function(e,t,i,a){return a?this.getServerUrl()+"/photo/:/transcode?url="+encodeURIComponent(e)+"&width="+t+"&height="+i:this.getServerUrl()+"/photo/:/transcode?url="+encodeURIComponent("http://localhost:"+this.getServerPort()+e)+"&width="+t+"&height="+i},PLEX.prototype.getTranscodedMediaFlagPath=function(e,t,i,a){return this.getServerUrl()+"/photo/:/transcode?url="+encodeURIComponent("http://localhost:"+this.getServerPort()+"/system/bundle/media/flags/"+e+"/"+t+"?t="+(new Date).getTime())+"&width="+i+"&height="+a},PLEX.prototype.getThumbHtml=function(e,t,i,a,r,s){var n="",o="",l=128,d=190;i&&i.indexOf("home")>-1&&(a="home");var c="1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"smallPicutres");switch(c&&"-1"==i.indexOf("recent")&&(l=180,d=270,o="bigger "),a){case"movie":n='<li class="media '+o+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>',n+='<div class="thumb '+o+'" data-original="'+this.getTranscodedPath(s.thumb,l,d)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&(n+='<div class="subtitle alt">'+t+"</div>"),"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&(n+='<div class="watchedStatus">'+this.getWatchedIconHtml(s.lastViewedAt,s.viewOffset,s.viewCount,s.duration)+"</div>"),n+="</a></li>";break;case"photo":n=s.media?'<li class="media '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>':'<li class="media '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="folder" data-art="'+s.art+'" data-media="'+s.media+'" data-filter="'+s.filter+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,300,190)+'"></div>',n+='<div class="subtitle alt">'+t+"</div>",n+="</a></li>";break;case"home":n='<li class="media '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,190,190)+'"></div>',n+='<div class="subtitle alt">'+t+"</div>",n+="</a></li>";break;case"episode":n='<li class="media '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>',n+=i&&i.indexOf("recent")>-1?'<div class="thumb" data-original="'+this.getTranscodedPath(s.grandparentThumb,300,190)+'"></div>':'<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,300,190)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&s.series&&(n+='<div class="title">'+s.series+"</div>"),n+='<div class="subtitle alt">'+(s.season?s.season+".":"")+s.episode+" "+t+"</div>","1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&(n+='<div class="watchedStatus">'+this.getWatchedIconHtml(s.lastViewedAt,s.viewOffset,s.viewCount,s.duration)+"</div>"),n+="</a></li>";break;case"show":n='<li class="media '+o+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" href>',n+='<div class="thumb '+o+'" data-original="'+this.getTranscodedPath(s.thumb,l,d)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&(n+='<div class="subtitle alt">'+t+"</div>"),"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&(n+='<div class="watchedStatus unwatched-count-badge badge badge-lg">'+(Number(s.leafCount)-Number(s.viewedLeafCount))+"</div>"),n+="</a></li>";break;case"artist":n='<li class="media '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,190,190)+'"></div>',n+='<div class="subtitle alt">'+t+"</div>",n+="</a></li>";break;case"channel":n='<li class="media '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,128,190,!0)+'"></div>',n+='<div class="subtitle alt">'+t+"</div>",n+="</a></li>";break;case"playlist":n='<li class="media '+o+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" href>',n+='<div class="thumb '+o+'" data-original="'+this.getTranscodedPath(s.thumb,l,d,!0)+'"></div>',n+='<div class="subtitle alt">'+t+"</div>",n+="</a></li>";break;case"album":n='<li class="media '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-parent-key="'+s.parentKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,190,190)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&s.artist&&(n+='<div class="title">'+s.artist+"</div>"),n+='<div class="subtitle alt">'+t+"</div>",n+="</a></li>";break;case"track":n='<li class="'+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-media="'+s.media+'" data-duration="'+s.duration+'" href>',n+='<div class="track-title"><i class="glyphicon"></i>'+s.index+". "+t+"</div>",n+="</a></li>";break;case"clip":n='<li class="media '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,128,190)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&(n+='<div class="subtitle alt">'+t+"</div>"),"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&(n+='<div class="watchedStatus">'+this.getWatchedIconHtml(s.lastViewedAt,s.viewOffset,s.viewCount,s.duration)+"</div>"),n+="</a></li>";break;default:n='<li class="media '+s.filter+'"><a data-key-index="'+e+'" data-title="'+t+'"',n+=' data-key="'+r+'" data-section-type="'+i+'" data-section-key="'+s.sectionKey+'" data-media-type="folder" data-filter="'+s.filter+'" href>',n+='<div class="thumb" data-original="./system/images/folder.png"></div>',n+='<div class="subtitle">'+t+"</div>",n+="</a></li>"}return n},PLEX.prototype.getListHtml=function(e,t,i,a,r,s){var n="";switch(i&&i.indexOf("home")>-1&&(a="home"),a){case"movie":case"photo":case"home":case"episode":case"show":case"artist":case"album":case"playlist":n='<li class="list '+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-parent-key="'+s.parentKey+'" data-section-type="'+i+'" data-media-type="'+a+'" href>',n+='<span class="listTitle">'+t+"</div>",s.year&&(n+='<span class="listYear">'+s.year+this.getWatchedIconHtml(s.lastViewedAt,s.viewOffset,s.viewCount,s.duration)+"</div>"),n+="</a></li>";break;case"track":n='<li class="'+a+'"><a data-key-index="'+e+'" data-title="'+t+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-media="'+s.media+'" href>',n+='<div class="track-title"><i class="glyphicon"></i>'+s.index+". "+t+"</div>",n+="</a></li>";break;default:n='<li class="list '+s.filter+'"><a data-key-index="'+e+'" data-title="'+t+'"',n+=' data-key="'+r+'" data-section-type="'+i+'" data-section-key="'+s.sectionKey+'" data-media-type="folder" data-filter="'+s.filter+'" href>',n+='<span class="title">'+t+"</div>",n+="</a></li>"}return n},PLEX.prototype.getMediaHtml=function(e,t,i){var a='<div class="'+t+'">';switch(t){case"movie":a+='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.art,350,350)+"')\"></div>",a+='<div class="title">'+e+"</div>",i.year&&(a+='<div class="time"><span class="duration">'+this.getTimeFromMS(i.duration),a+=this.getWatchedIconHtml(i.lastViewedAt,i.viewOffset,i.viewCount,i.duration),a+='</span><span class="year">'+i.year+"</span></div>"),i.tagline&&(a+='<div class="tagline">'+i.tagline+"</div>"),i.summary&&(a+='<div class="summary">'+i.summary+"</div>"),i.roles&&i.roles.length>0&&(a+='<div class="roles">'+i.roles.join(", ")+"</div>"),i.genre&&i.genre.length>0&&(a+='<div class="genre">'+i.genre.join(", ")+"</div>"),i.director&&(a+='<div class="director">'+i.director+"</div>"),i.width&&(a+='<div class="resolution">'+i.width+"x"+i.height+"</div>"),i.studio&&(a+='<div class="studio"><img src="'+this.getTranscodedMediaFlagPath("studio",i.studio,150,40)+'"/></div>'),i.contentRating&&(a+='<div class="contentRating"><img src="'+this.getTranscodedMediaFlagPath("contentRating",i.contentRating,80,40)+'"/></div>');break;case"photo":a='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.thumb,350,350)+"')\"></div>",a+='<div class="title">'+e+"</div>",i.year&&(a+='<div class="time">'+i.year+"</div>"),i.summary&&(a+='<div class="summary">'+i.summary+"</div>"),a+='<div class="dimensions">',i.width&&(a+='<span class="width">'+i.width+"</span>"),i.height&&(a+='<span class="height">'+i.height+"</span>"),a+="</div>",i.container&&(a+='<div class="container">'+i.container+"</div>");break;case"home":a='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.art,350,350)+"')\"></div>",a+='<div class="title">'+e+"</div>";break;case"episode":case"show":a='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.thumb,350,350)+"')\"></div>",a+='<div class="title">'+e+"</div>",a+='<div class="subtitle">',i.parentIndex&&(a+='<span class="season-n">'+i.parentIndex+"</span>"),i.index&&(a+='<span class="episode-n">'+i.index+"</span>"),a+="</div>",i.grandparentTitle&&(a+='<div class="tagline">'+i.grandparentTitle+"</div>"),i.year&&(a+='<div class="time">'+i.year+this.getWatchedIconHtml(i.lastViewedAt,i.viewOffset,i.viewCount,i.duration)+"</div>"),i.summary&&(a+='<div class="summary">'+i.summary+"</div>"),i.contentRating&&(a+='<div class="contentRating"><img src="'+this.getTranscodedMediaFlagPath("contentRating",i.contentRating,80,40)+'"/></div>'),i.width&&(a+='<div class="resolution">'+i.width+"x"+i.height+"</div>");break;case"artist":case"album":a='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.art,350,350)+"')\"></div>",a+='<div class="title">'+e+"</div>",i.year&&(a+='<div class="time">'+i.year+"</div>"),i.artist&&(a+='<div class="artist">'+i.artist+"</div>"),i.tracks.length>0&&(a+='<div class="summary">'+i.tracks.join("<br/>")+"</div>"),i.thumb&&(a+='<div class="cover"><img src="'+this.getTranscodedPath(i.thumb,100,100)+'"/></div>')}return a+="</div>"},PLEX.prototype.getMediaPreviewHtml=function(e){var t=$(e).find("MediaContainer:first").children().first(),i=t.find("Media:first"),a=t.attr("type"),r=$(e).find($(e).find("Media:first Stream[streamType='2'][selected='1']").length>0?"Media:first Stream[streamType='2'][selected='1']":"Media:first Stream[streamType='2']:first"),s=$(e).find($(e).find("Media:first Stream[streamType='3'][selected='1']").length>0?"Media:first Stream[streamType='3'][selected='1']":"Media:first Stream[streamType='3']"),n='<div class="'+a+'">',o=!1;switch(a){case"clip":o=!0;case"movie":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(t.attr("thumb"),300,440,o)+"')\"></div>",n+='<div class="media">',i.attr("videoResolution")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("videoResolution",i.attr("videoResolution"),100,20)+'"/>'),i.attr("audioCodec")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("audioCodec",i.attr("audioCodec"),100,20)+'"/>'),i.attr("audioChannels")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("audioChannels",i.attr("audioChannels"),100,20)+'"/>'),n+="</div>",n+="</div>",n+='<div class="rightColumn">',n+='<div class="title">'+t.attr("title")+"</div>",n+='<div class="time">',t.attr("duration")&&(n+='<span class="duration">'+this.getTimeFromMS(t.attr("duration")),n+=this.getWatchedIconHtml(t.attr("lastViewedAt"),t.attr("viewOffset"),t.attr("viewCount"),t.attr("duration")),n+="</span>"),t.attr("year")&&(n+='<span class="year">'+t.attr("year")+"</span>"),n+="</div>",t.attr("tagline")&&(n+='<div class="tagline">'+t.attr("tagline")+"</div>"),t.attr("summary")&&(n+='<div class="summary">'+t.attr("summary")+"</div>"),t.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(t.find("Genre"),"tag",", ")+"</div>"),t.find("Director").length>0&&(n+='<div class="director">'+t.find("Director").attr("tag")+"</div>"),t.find("Role").length>0&&(n+='<div class="roles">'+this.getAttributeList(t.find("Role"),"tag",", ")+"</div>"),r.length>0&&(n+='<div class="audio">'+(r.attr("language")||"Unknown")+" ("+r.attr("codec")+")</div>"),s.length>0&&(n+=1==s.length?'<div class="subtitles">'+s.attr("language")+" ("+s.attr("format")+")</div>":'<div class="subtitles">Disabled</div>'),i.attr("width")&&(n+='<div class="resolution">'+i.attr("width")+"x"+i.attr("height")+"</div>"),t.attr("studio")&&(n+='<div class="studio"><img src="'+this.getTranscodedMediaFlagPath("studio",t.attr("studio"),300,40)+'"/></div>'),t.attr("contentRating")&&(n+='<div class="contentRating"><img src="'+this.getTranscodedMediaFlagPath("contentRating",t.attr("contentRating"),70,25)+'"/></div>'),n+="</div>";break;case"photo":n+='<div class="leftColumn">',n+='<div class="title">'+(t.attr("parentTitle")?t.attr("parentTitle")+"/":"")+t.attr("title")+"</div>",t.attr("year")&&(n+='<div class="time"><div class="year">'+t.attr("year")+"</div></div>"),t.attr("summary")&&(n+='<div class="summary">'+t.attr("summary")+"</div>"),i.attr("width")&&(n+='<div class="dimensions"><span class="width">'+i.attr("width")+"</span></div>"),i.attr("height")&&(n+='<div class="dimensions"><span class="height">'+i.attr("height")+"</span></div>"),i.attr("container")&&(n+='<div class="container">'+i.attr("container")+"</div>"),n+="</div>",n+='<div class="rightColumn">',n+='<div class="cover">',n+='<img class="photo" src="'+this.getTranscodedPath(t.find("Part").attr("key"),800,600)+'"/>',n+="</div>",n+="</div>";break;case"album":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(t.attr("thumb"),320,320)+"')\"></div>",n+='<div class="title">'+t.attr("title")+"</div>",n+='<div class="time">',t.attr("year")&&(n+='<span class="year">'+t.attr("year")+"</span>"),n+="</div>",t.attr("summary")&&(n+='<div class="summary">'+t.attr("summary")+"</div>"),t.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(t.find("Genre"),"tag",", ")+"</div>"),n+="</div>",n+='<div class="rightColumn">',n+='<div id="children"><ul></ul></div>',n+="</div>";break;case"artist":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(t.attr("thumb"),380,380)+"')\"></div>",n+='<div class="title">'+t.attr("title")+"</div>",t.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(t.find("Genre"),"tag",", ")+"</div>"),t.attr("summary")&&(n+='<div class="summary">'+t.attr("summary")+"</div>"),n+="</div>",n+='<div class="rightColumn">',n+='<div id="children"><ul></ul></div>',n+="</div>";break;case"show":case"season":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(t.attr("thumb"),300,440)+"')\"></div>",t.attr("parentTitle")&&(n+='<div class="title">'+t.attr("parentTitle")+"</div>"),n+='<div class="title">'+t.attr("title")+"</div>",n+='<div class="time">',t.attr("duration")&&(n+='<span class="duration">'+this.getTimeFromMS(t.attr("duration"))+"</span>"),t.attr("year")&&(n+='<span class="year">'+t.attr("year")+"</span>"),n+="</div>",t.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(t.find("Genre"),"tag",", ")+"</div>"),t.attr("summary")&&(n+='<div class="summary">'+t.attr("summary")+"</div>"),n+="</div>",n+='<div class="rightColumn">',n+='<div id="children"><ul></ul></div>',t.attr("theme")&&(n+='<div id="theme" data-src="'+this.getServerUrl()+t.attr("theme")+'"></div>'),n+="</div>";break;case"episode":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(t.attr("thumb"),380,256)+"')\"></div>",n+='<div class="media">',i.attr("videoResolution")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("videoResolution",i.attr("videoResolution"),100,20)+'"/>'),i.attr("audioCodec")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("audioCodec",i.attr("audioCodec"),100,20)+'"/>'),i.attr("audioChannels")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("audioChannels",i.attr("audioChannels"),100,20)+'"/>'),n+="</div>",n+="</div>",n+='<div class="rightColumn">',n+='<div class="title">'+t.attr("title")+"</div>",n+='<div class="time">',t.attr("duration")&&(n+='<span class="duration">'+this.getTimeFromMS(t.attr("duration")),n+=this.getWatchedIconHtml(t.attr("lastViewedAt"),t.attr("viewOffset"),t.attr("viewCount"),t.attr("duration")),n+="</span>"),t.attr("year")&&(n+='<span class="year">'+t.attr("year")+"</span>"),n+="</div>",t.attr("summary")&&(n+='<div class="summary">'+t.attr("summary")+"</div>"),t.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(t.find("Genre"),"tag",", ")+"</div>"),t.find("Role").length>0&&(n+='<div class="roles">'+this.getAttributeList(t.find("Role"),"tag",", ")+"</div>"),t.find("Writer").length>0&&(n+='<div class="writer">'+this.getAttributeList(t.find("Writer"),"tag",", ")+"</div>"),t.find("Director").length>0&&(n+='<div class="director">'+this.getAttributeList(t.find("Director"),"tag",", ")+"</div>"),r.length>0&&(n+='<div class="audio">'+(r.attr("language")||"Unknown")+" ("+r.attr("codec")+")</div>"),s.length>0&&(n+=1==s.length?'<div class="subtitles">'+s.attr("language")+" ("+s.attr("format")+")</div>":'<div class="subtitles">Disabled</div>'),i.attr("width")&&(n+='<div class="resolution">'+i.attr("width")+"x"+i.attr("height")+"</div>"),n+="</div>"}return n+="</div>"},PLEX.prototype.getWatchedIconHtml=function(e,t,i,a){return i?'<span id="watchStatus" class=""></span>':t?t/a>.9?'<span id="watchStatus" class=""></span>':'<span id="watchStatus" class="unwatched-icon unwatched-partial-icon"></span>':'<span id="watchStatus" class="unwatched-icon unwatched-full-icon"></span>'},PLEX.prototype.getAttributeList=function(e,t,i){var a=[];return e.each(function(){a.push($(this).attr(t))}),a.join(i)},PLEX.prototype.getTimeFromMS=function(e){if(!e)return"";var i=(parseInt(e%1e3/100),parseInt(e/1e3%60)),a=parseInt(e/6e4%60),r=parseInt(e/36e5%24);return r=10>r?"0"+r:r,a=10>a?"0"+a:a,i=10>i?"0"+i:i,r+":"+a+":"+i},PLEX.prototype.getGenericTranscodeUrl=function(e,t,i){i=i||{};var a=i.offset||0,r=i.quality||7,s=i.format||"mpegts",n=i.audioCodec||"libfaac",o=i.audioBitrate||128,l=i.videoCodec||"libx264",d=i.videoBitrate||3e3,c="/video/:/transcode/generic."+s+"?";return c+="identifier="+encodeURIComponent("com.plexapp.plugins.library"),c+="&format="+s,c+="&videoCodec="+l+"&videoBitrate="+d,c+="&audioCodec="+n+"&audioBitrate="+o,c+="&size=1280x720",c+="&width=1280&height=720",c+="&quality="+r,c+="&fakeContentLength=2000000000",c+="&offset="+a,c+="&key="+encodeURIComponent("http://127.0.0.1:"+this.getServerPort()+e),c+="&url="+encodeURIComponent("http://127.0.0.1:"+this.getServerPort()+t),this.getServerUrl()+c},PLEX.prototype.getHlsTranscodeUrl=function(e,t){t=t||{};var i="http://127.0.0.1:32400"+e,a=localStorage.getItem(this.PLEX_SESSION_ID),r=t.mediaIndex||"0",s=t.partIndex||"0",n=t.protocol||"hls",o=t.offset||"0",l=t.fastSeek||"1",d=t.directPlay||"1",c=t.directStream||"1",h=t.videoQuality||"75",u=t.maxVideoBitrate||"3000",f=t.subtitleSize||"90",m=t.audioBoost||"100",g="1920x1080",p="/video/:/transcode/universal/start.m3u8?";return p+="path="+encodeURIComponent(i),p+="&mediaIndex="+r,p+="&partIndex="+s,p+="&protocol="+n,p+="&offset="+o,p+="&fastSeek="+l,p+="&directPlay="+d,p+="&directStream="+c,p+="&videoQuality="+h,p+="&maxVideoBitrate="+u,p+="&subtitleSize="+f,p+="&audioBoost="+m,p+="&videoResolution="+g,p+="&videoQuality="+h,p+="&session="+a,p+="&X-Plex-Client-Identifier="+this.X_Plex_Client_Identifier,p+="&X-Plex-Product="+this.X_Plex_Product,p+="&X-Plex-Device="+this.X_Plex_Device,p+="&X-Plex-Platform="+this.X_Plex_Platform,p+="&X-Plex-Platform-Version="+this.X_Plex_Platform_Version,p+="&X-Plex-Version="+this.X_Plex_Version,p+="&X-Plex-Device-Name="+this.X_Plex_Device_Name,this.getServerUrl()+p},PLEX.prototype.getTimeline=function(e,t,i,a){$.ajax({type:"GET",url:this.getServerUrl()+"/:/timeline?time="+i+"&duration="+a+"&state="+t+"&key=%2Flibrary%2Fmetadata%2F"+e+"&ratingKey="+e,headers:{"X-Plex-Client-Identifier":this.X_Plex_Client_Identifier,"X-Plex-Product":this.X_Plex_Product,"X-Plex-Device":this.X_Plex_Device,"X-Plex-Platform":this.X_Plex_Platform,"X-Plex-Platform-Version":this.X_Plex_Platform_Version,"X-Plex-Version":this.X_Plex_Version,"X-Plex-Device-Name":this.X_Plex_Device_Name}})},PLEX.prototype.ping=function(){$.ajax({type:"GET",url:this.getServerUrl()+"/video/:/transcode/universal/ping?session="+this.X_Plex_Client_Identifier,headers:{"X-Plex-Client-Identifier":this.X_Plex_Client_Identifier,"X-Plex-Product":this.X_Plex_Product,"X-Plex-Device":this.X_Plex_Device,"X-Plex-Platform":this.X_Plex_Platform,"X-Plex-Platform-Version":this.X_Plex_Platform_Version,"X-Plex-Version":this.X_Plex_Version,"X-Plex-Device-Name":this.X_Plex_Device_Name}})},PLEX.prototype.getSessionID=function(){return Math.random().toString(16).substr(2)+Math.random().toString(16).substr(2)},PLEX.prototype.panic=function(){this.setShouldShowHiddenFiles("false"),this.removeServerUrl(),location.href="index.html",window.close()};