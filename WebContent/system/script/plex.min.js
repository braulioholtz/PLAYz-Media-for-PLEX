function PLEX(){this.PLEX_SESSION_ID="plexSessionID",this.LG_PLEX_SERVER="plexServerUrl",this.PLEX_OPTIONS_PREFIX="plexOptions-",this.PLEX_CACHE="cache:",this.PLEX_SHOW_HIDDEN_FILES="plexHiddenFiles",this.X_Plex_Client_Identifier=localStorage.getItem(this.PLEX_SESSION_ID),this.X_Plex_Chunked="1",this.X_Plex_Product="Plex%20Web",this.X_Plex_Version="2.4.9",this.X_Plex_Platform="Chrome",this.X_Plex_Platform_Version="7",this.X_Plex_Version="1.2.12",this.X_Plex_Platform_Version="43.0",this.X_Plex_Device="Windows",this.X_Plex_Device_Name="Plex%2FWeb%20(Chrome)";var t=new Date;this.time=t.getTime()}PLEX.prototype.getShouldShowHiddenFiles=function(){return localStorage.getItem(this.PLEX_SHOW_HIDDEN_FILES)&&""!=localStorage.getItem(this.PLEX_SHOW_HIDDEN_FILES)?"true"==localStorage.getItem(this.PLEX_SHOW_HIDDEN_FILES)?!0:!1:(this.setShouldShowHiddenFiles("false"),!1)},PLEX.prototype.setShouldShowHiddenFiles=function(t){localStorage.setItem(this.PLEX_SHOW_HIDDEN_FILES,t)},PLEX.prototype.isMarkedAsHidden=function(t,e){return 0!=$(t).attr(e).length?-1!=$(t).attr(e).indexOf("[p]")||-1!=$(t).attr(e).indexOf("[P]"):!1},PLEX.prototype.setServerUrl=function(t){localStorage.setItem(this.LG_PLEX_SERVER,t)},PLEX.prototype.getServerUrl=function(){return localStorage.getItem(this.LG_PLEX_SERVER)},PLEX.prototype.getServerPort=function(){return localStorage.getItem(this.LG_PLEX_SERVER).substr(localStorage.getItem(this.LG_PLEX_SERVER).lastIndexOf(":")+1)},PLEX.prototype.removeServerUrl=function(){localStorage.removeItem(this.LG_PLEX_SERVER)},PLEX.prototype.getLibraryServer=function(t){$.get(this.getServerUrl(),t)},PLEX.prototype.checkLibraryServerExists=function(t,e){$.ajax({url:this.getServerUrl(),success:t,error:e,timeout:2e4})},PLEX.prototype.scanNetwork=function(t,e,a,r){var s="";for(i=0;255>=i;i++)s="http://"+t.substr(0,t.lastIndexOf(".")+1)+i.toString()+":32400",$.ajax({url:s,success:e,error:a,complete:r,timeout:2e4})},PLEX.prototype.getMediaType=function(t,e){switch(e){case"movie":if(t.indexOf("Home")>-1)return"home"}return e},PLEX.prototype.getPlaylists=function(t){$.get(this.getServerUrl()+"/playlists/all",t)},PLEX.prototype.removeHiddenToken=function(t){return t.replace("[p]","").replace("[P]","")},PLEX.prototype.isTreeContainsHiddenFiles=function(t,e){var i=!1,a=this;if("search"==e)$.ajax({type:"GET",url:a.getServerUrl()+$(t).attr("key"),dataType:"xml",async:!1,success:function(t){$(t).find("MediaContainer").each(function(t,e){return i=a.isMarkedAsHidden(e,"librarySectionTitle"),i?!0:void 0})}});else{if("playlist"!=$(t).attr("type"))return!1;$.ajax({type:"GET",url:a.getServerUrl()+$(t).attr("key"),dataType:"xml",async:!1,success:function(t){$(t).find("Video").each(function(t,e){i||(i="bla3",$.ajax({type:"GET",url:a.getServerUrl()+$(e).attr("key"),dataType:"xml",async:!1,success:function(t){$(t).find("MediaContainer").each(function(t,e){return i=a.isMarkedAsHidden(e,"librarySectionTitle"),i?!0:void 0}),i||$(t).find("Video").each(function(t,e){return i=a.isMarkedAsHidden(e,"title"),i?!0:void 0})}}))})}})}return i},PLEX.prototype.getSections=function(t){$.get(this.getServerUrl()+"/library/sections",t)},PLEX.prototype.getSectionDetails=function(t,e){$.get(this.getServerUrl()+"/library/sections/"+t,e)},PLEX.prototype.getSectionMedia=function(t,e,i,a,r,s){var l=("callback"+(new Date).getTime(),this),o="";s=s||{};s.start||-1,s.size||-1;if("undefined"!=typeof s.start&"undefined"!=typeof s.size&&(o="&X-Plex-Container-Start="+s.start+"&X-Plex-Container-Size="+s.size),a)switch(i){case"folder":case"all":i=decodeURIComponent(a),i.indexOf("?")>-1?$.get(this.getServerUrl()+i+"&X-Plex-Access-Time="+this.time+o,r):$.get(this.getServerUrl()+i+"?X-Plex-Access-Time="+this.time+o,r);break;case"search":$.get(this.getServerUrl()+"/search?query="+a+o,r);break;default:$.get(this.getServerUrl()+"/library/sections/"+e+"/"+i+"/"+a+"?X-Plex-Access-Time="+this.time+o,r)}else switch(t){case"channels":"channels"==e?l.getChannels(e,r):$.get(this.getServerUrl()+e,r);break;case"playlists":"playlists"==e?l.getPlaylists(r):$.get(this.getServerUrl()+"/playlists/"+e+"/items/",r);break;default:$.get(this.getServerUrl()+"/library/sections/"+e+"/"+i+"?X-Plex-Access-Time="+this.time+o,r)}},PLEX.prototype.getRecentlyAdded=function(t,e){$.get(this.getServerUrl()+"/library/sections/"+t+"/recentlyAdded?X-Plex-Container-Start=0&X-Plex-Container-Size=25",e)},PLEX.prototype.getOnDeck=function(t,e){$.get(this.getServerUrl()+"/library/onDeck?X-Plex-Container-Start=0&X-Plex-Container-Size=25",e)},PLEX.prototype.getChannels=function(t,e){$.get(this.getServerUrl()+"/channels/all",e)},PLEX.prototype.getMediaItems=function(t,e,i){switch(t){case"ondeck":this.getOnDeck(e,i);break;case"channels":this.getChannels(e,i);break;case"playlists":break;default:this.getRecentlyAdded(e,i)}},PLEX.prototype.getMediaMetadata=function(t,e){t.indexOf("?")>-1?$.get(this.getServerUrl()+t+"&X-Plex-Access-Time="+this.time,e):$.get(this.getServerUrl()+t+"?X-Plex-Access-Time="+this.time,e)},PLEX.prototype.reportProgress=function(t,e,i){$.get(this.getServerUrl()+"/:/progress?key="+t+"&identifier=com.plexapp.plugins.library&time="+Math.round(i)+"&state="+e,null)},PLEX.prototype.setWatched=function(t,e){$.get(this.getServerUrl()+"/:/scrobble?key="+t+"&identifier=com.plexapp.plugins.library",e)},PLEX.prototype.setUnwatched=function(t,e){$.get(this.getServerUrl()+"/:/unscrobble?key="+t+"&identifier=com.plexapp.plugins.library",e)},PLEX.prototype.setAudioStream=function(t,e){$.ajax({type:"PUT",url:this.getServerUrl()+"/library/parts/"+t+"?audioStreamID="+e})},PLEX.prototype.setSubtitleStream=function(t,e){$.ajax({type:"PUT",url:this.getServerUrl()+"/library/parts/"+t+"?subtitleStreamID="+e})},PLEX.prototype.getTranscodedPath=function(t,e,i,a){return a?this.getServerUrl()+"/photo/:/transcode?url="+encodeURIComponent(t)+"&width="+e+"&height="+i:this.getServerUrl()+"/photo/:/transcode?url="+encodeURIComponent("http://localhost:"+this.getServerPort()+t)+"&width="+e+"&height="+i},PLEX.prototype.getTranscodedMediaFlagPath=function(t,e,i,a){return this.getServerUrl()+"/photo/:/transcode?url="+encodeURIComponent("http://localhost:"+this.getServerPort()+"/system/bundle/media/flags/"+t+"/"+e+"?t="+(new Date).getTime())+"&width="+i+"&height="+a},PLEX.prototype.getThumbHtml=function(t,e,i,a,r,s){var n="",l="",o=128,d=190;i&&i.indexOf("home")>-1&&(a="home");var c="1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"smallPicutres");switch(c&&"-1"==i.indexOf("recent")&&(o=180,d=270,l="bigger "),a){case"movie":n='<li class="media '+l+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>',n+='<div class="thumb '+l+'" data-original="'+this.getTranscodedPath(s.thumb,o,d)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&(n+='<div class="subtitle alt">'+e+"</div>"),"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&(n+='<div class="watchedStatus">'+this.getWatchedIconHtml(s.lastViewedAt,s.viewOffset,s.viewCount,s.duration)+"</div>"),n+="</a></li>";break;case"photo":n=s.media?'<li class="media '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>':'<li class="media '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="folder" data-art="'+s.art+'" data-media="'+s.media+'" data-filter="'+s.filter+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,300,190)+'"></div>',n+='<div class="subtitle alt">'+e+"</div>",n+="</a></li>";break;case"home":n='<li class="media '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,190,190)+'"></div>',n+='<div class="subtitle alt">'+e+"</div>",n+="</a></li>";break;case"episode":n='<li class="media '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>',n+=i&&i.indexOf("recent")>-1?'<div class="thumb" data-original="'+this.getTranscodedPath(s.grandparentThumb,300,190)+'"></div>':'<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,300,190)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&s.series&&(n+='<div class="title">'+s.series+"</div>"),n+='<div class="subtitle alt">'+(s.season?s.season+".":"")+s.episode+" "+e+"</div>","1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&(n+='<div class="watchedStatus">'+this.getWatchedIconHtml(s.lastViewedAt,s.viewOffset,s.viewCount,s.duration)+"</div>"),n+="</a></li>";break;case"show":n='<li class="media '+l+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" href>',n+='<div class="thumb '+l+'" data-original="'+this.getTranscodedPath(s.thumb,o,d)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&(n+='<div class="subtitle alt">'+e+"</div>"),"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&(n+='<div class="watchedStatus unwatched-count-badge badge badge-lg">'+(Number(s.leafCount)-Number(s.viewedLeafCount))+"</div>"),n+="</a></li>";break;case"artist":n='<li class="media '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,190,190)+'"></div>',n+='<div class="subtitle alt">'+e+"</div>",n+="</a></li>";break;case"channel":n='<li class="media '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,128,190,!0)+'"></div>',n+='<div class="subtitle alt">'+e+"</div>",n+="</a></li>";break;case"playlist":n='<li class="media '+l+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" href>',n+='<div class="thumb '+l+'" data-original="'+this.getTranscodedPath(s.thumb,o,d,!0)+'"></div>',n+='<div class="subtitle alt">'+e+"</div>",n+="</a></li>";break;case"album":n='<li class="media '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-parent-key="'+s.parentKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,190,190)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&s.artist&&(n+='<div class="title">'+s.artist+"</div>"),n+='<div class="subtitle alt">'+e+"</div>",n+="</a></li>";break;case"track":n='<li class="'+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-media="'+s.media+'" data-duration="'+s.duration+'" href>',n+='<div class="track-title"><i class="glyphicon"></i>'+s.index+". "+e+"</div>",n+="</a></li>";break;case"clip":n='<li class="media '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-art="'+s.art+'" data-media="'+s.media+'" href>',n+='<div class="thumb" data-original="'+this.getTranscodedPath(s.thumb,128,190)+'"></div>',"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"titleOverlay")&&(n+='<div class="subtitle alt">'+e+"</div>"),"1"!=localStorage.getItem(this.PLEX_OPTIONS_PREFIX+"watchedIcons")&&(n+='<div class="watchedStatus">'+this.getWatchedIconHtml(s.lastViewedAt,s.viewOffset,s.viewCount,s.duration)+"</div>"),n+="</a></li>";break;default:n='<li class="media '+s.filter+'"><a data-key-index="'+t+'" data-title="'+e+'"',n+=' data-key="'+r+'" data-section-type="'+i+'" data-section-key="'+s.sectionKey+'" data-media-type="folder" data-filter="'+s.filter+'" href>',n+='<div class="thumb" data-original="./system/images/folder.png"></div>',n+='<div class="subtitle">'+e+"</div>",n+="</a></li>"}return n},PLEX.prototype.getListHtml=function(t,e,i,a,r,s){var n="";switch(i&&i.indexOf("home")>-1&&(a="home"),a){case"movie":case"photo":case"home":case"episode":case"show":case"artist":case"album":case"playlist":n='<li class="list '+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-parent-key="'+s.parentKey+'" data-section-type="'+i+'" data-media-type="'+a+'" href>',n+='<span class="listTitle">'+e+"</div>",s.year&&(n+='<span class="listYear">'+s.year+this.getWatchedIconHtml(s.lastViewedAt,s.viewOffset,s.viewCount,s.duration)+"</div>"),n+="</a></li>";break;case"track":n='<li class="'+a+'"><a data-key-index="'+t+'" data-title="'+e+'" data-key="'+r+'" data-section-key="'+s.sectionKey+'" data-section-type="'+i+'" data-media-type="'+a+'" data-media="'+s.media+'" href>',n+='<div class="track-title"><i class="glyphicon"></i>'+s.index+". "+e+"</div>",n+="</a></li>";break;default:n='<li class="list '+s.filter+'"><a data-key-index="'+t+'" data-title="'+e+'"',n+=' data-key="'+r+'" data-section-type="'+i+'" data-section-key="'+s.sectionKey+'" data-media-type="folder" data-filter="'+s.filter+'" href>',n+='<span class="title">'+e+"</div>",n+="</a></li>"}return n},PLEX.prototype.getMediaHtml=function(t,e,i){var a='<div class="'+e+'">';switch(e){case"movie":a+='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.art,350,350)+"')\"></div>",a+='<div class="title">'+t+"</div>",i.year&&(a+='<div class="time"><span class="duration">'+this.getTimeFromMS(i.duration),a+=this.getWatchedIconHtml(i.lastViewedAt,i.viewOffset,i.viewCount,i.duration),a+='</span><span class="year">'+i.year+"</span></div>"),i.tagline&&(a+='<div class="tagline">'+i.tagline+"</div>"),i.summary&&(a+='<div class="summary">'+i.summary+"</div>"),i.roles&&i.roles.length>0&&(a+='<div class="roles">'+i.roles.join(", ")+"</div>"),i.genre&&i.genre.length>0&&(a+='<div class="genre">'+i.genre.join(", ")+"</div>"),i.director&&(a+='<div class="director">'+i.director+"</div>"),i.width&&(a+='<div class="resolution">'+i.width+"x"+i.height+"</div>"),i.studio&&(a+='<div class="studio"><img src="'+this.getTranscodedMediaFlagPath("studio",i.studio,150,40)+'"/></div>'),i.contentRating&&(a+='<div class="contentRating"><img src="'+this.getTranscodedMediaFlagPath("contentRating",i.contentRating,80,40)+'"/></div>');break;case"photo":a='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.thumb,350,350)+"')\"></div>",a+='<div class="title">'+t+"</div>",i.year&&(a+='<div class="time">'+i.year+"</div>"),i.summary&&(a+='<div class="summary">'+i.summary+"</div>"),a+='<div class="dimensions">',i.width&&(a+='<span class="width">'+i.width+"</span>"),i.height&&(a+='<span class="height">'+i.height+"</span>"),a+="</div>",i.container&&(a+='<div class="container">'+i.container+"</div>");break;case"home":a='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.art,350,350)+"')\"></div>",a+='<div class="title">'+t+"</div>";break;case"episode":case"show":a='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.thumb,350,350)+"')\"></div>",a+='<div class="title">'+t+"</div>",a+='<div class="subtitle">',i.parentIndex&&(a+='<span class="season-n">'+i.parentIndex+"</span>"),i.index&&(a+='<span class="episode-n">'+i.index+"</span>"),a+="</div>",i.grandparentTitle&&(a+='<div class="tagline">'+i.grandparentTitle+"</div>"),i.year&&(a+='<div class="time">'+i.year+this.getWatchedIconHtml(i.lastViewedAt,i.viewOffset,i.viewCount,i.duration)+"</div>"),i.summary&&(a+='<div class="summary">'+i.summary+"</div>"),i.contentRating&&(a+='<div class="contentRating"><img src="'+this.getTranscodedMediaFlagPath("contentRating",i.contentRating,80,40)+'"/></div>'),i.width&&(a+='<div class="resolution">'+i.width+"x"+i.height+"</div>");break;case"artist":case"album":a='<div class="thumb" style="background-image: url(\''+this.getTranscodedPath(i.art,350,350)+"')\"></div>",a+='<div class="title">'+t+"</div>",i.year&&(a+='<div class="time">'+i.year+"</div>"),i.artist&&(a+='<div class="artist">'+i.artist+"</div>"),i.tracks.length>0&&(a+='<div class="summary">'+i.tracks.join("<br/>")+"</div>"),i.thumb&&(a+='<div class="cover"><img src="'+this.getTranscodedPath(i.thumb,100,100)+'"/></div>')}return a+="</div>"},PLEX.prototype.getMediaPreviewHtml=function(t){var e=$(t).find("MediaContainer:first").children().first(),i=e.find("Media:first"),a=e.attr("type"),r=$(t).find($(t).find("Media:first Stream[streamType='2'][selected='1']").length>0?"Media:first Stream[streamType='2'][selected='1']":"Media:first Stream[streamType='2']:first"),s=$(t).find($(t).find("Media:first Stream[streamType='3'][selected='1']").length>0?"Media:first Stream[streamType='3'][selected='1']":"Media:first Stream[streamType='3']"),n='<div class="'+a+'">',l=!1;switch(a){case"clip":l=!0;case"movie":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(e.attr("thumb"),300,440,l)+"')\"></div>",n+='<div class="media">',i.attr("videoResolution")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("videoResolution",i.attr("videoResolution"),100,20)+'"/>'),i.attr("audioCodec")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("audioCodec",i.attr("audioCodec"),100,20)+'"/>'),i.attr("audioChannels")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("audioChannels",i.attr("audioChannels"),100,20)+'"/>'),n+="</div>",n+="</div>",n+='<div class="rightColumn">',n+='<div class="title">'+e.attr("title")+"</div>",n+='<div class="time">',e.attr("duration")&&(n+='<span class="duration">'+this.getTimeFromMS(e.attr("duration")),n+=this.getWatchedIconHtml(e.attr("lastViewedAt"),e.attr("viewOffset"),e.attr("viewCount"),e.attr("duration")),n+="</span>"),e.attr("year")&&(n+='<span class="year">'+e.attr("year")+"</span>"),n+="</div>",e.attr("tagline")&&(n+='<div class="tagline">'+e.attr("tagline")+"</div>"),e.attr("summary")&&(n+='<div class="summary">'+e.attr("summary")+"</div>"),e.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(e.find("Genre"),"tag",", ")+"</div>"),e.find("Director").length>0&&(n+='<div class="director">'+e.find("Director").attr("tag")+"</div>"),e.find("Role").length>0&&(n+='<div class="roles">'+this.getAttributeList(e.find("Role"),"tag",", ")+"</div>"),r.length>0&&(n+='<div class="audio">'+(r.attr("language")||"Unknown")+" ("+r.attr("codec")+")</div>"),s.length>0&&(n+=1==s.length?'<div class="subtitles">'+s.attr("language")+" ("+s.attr("format")+")</div>":'<div class="subtitles">Disabled</div>'),i.attr("width")&&(n+='<div class="resolution">'+i.attr("width")+"x"+i.attr("height")+"</div>"),e.attr("studio")&&(n+='<div class="studio"><img src="'+this.getTranscodedMediaFlagPath("studio",e.attr("studio"),300,40)+'"/></div>'),e.attr("contentRating")&&(n+='<div class="contentRating"><img src="'+this.getTranscodedMediaFlagPath("contentRating",e.attr("contentRating"),70,25)+'"/></div>'),n+="</div>";break;case"photo":n+='<div class="leftColumn">',n+='<div class="title">'+(e.attr("parentTitle")?e.attr("parentTitle")+"/":"")+e.attr("title")+"</div>",e.attr("year")&&(n+='<div class="time"><div class="year">'+e.attr("year")+"</div></div>"),e.attr("summary")&&(n+='<div class="summary">'+e.attr("summary")+"</div>"),i.attr("width")&&(n+='<div class="dimensions"><span class="width">'+i.attr("width")+"</span></div>"),i.attr("height")&&(n+='<div class="dimensions"><span class="height">'+i.attr("height")+"</span></div>"),i.attr("container")&&(n+='<div class="container">'+i.attr("container")+"</div>"),n+="</div>",n+='<div class="rightColumn">',n+='<div class="cover">',n+='<img class="photo" src="'+this.getTranscodedPath(e.find("Part").attr("key"),800,600)+'"/>',n+="</div>",n+="</div>";break;case"album":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(e.attr("thumb"),320,320)+"')\"></div>",n+='<div class="title">'+e.attr("title")+"</div>",n+='<div class="time">',e.attr("year")&&(n+='<span class="year">'+e.attr("year")+"</span>"),n+="</div>",e.attr("summary")&&(n+='<div class="summary">'+e.attr("summary")+"</div>"),e.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(e.find("Genre"),"tag",", ")+"</div>"),n+="</div>",n+='<div class="rightColumn">',n+='<div id="children"><ul></ul></div>',n+="</div>";break;case"artist":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(e.attr("thumb"),380,380)+"')\"></div>",n+='<div class="title">'+e.attr("title")+"</div>",e.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(e.find("Genre"),"tag",", ")+"</div>"),e.attr("summary")&&(n+='<div class="summary">'+e.attr("summary")+"</div>"),n+="</div>",n+='<div class="rightColumn">',n+='<div id="children"><ul></ul></div>',n+="</div>";break;case"show":case"season":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(e.attr("thumb"),300,440)+"')\"></div>",e.attr("parentTitle")&&(n+='<div class="title">'+e.attr("parentTitle")+"</div>"),n+='<div class="title">'+e.attr("title")+"</div>",n+='<div class="time">',e.attr("duration")&&(n+='<span class="duration">'+this.getTimeFromMS(e.attr("duration"))+"</span>"),e.attr("year")&&(n+='<span class="year">'+e.attr("year")+"</span>"),n+="</div>",e.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(e.find("Genre"),"tag",", ")+"</div>"),e.attr("summary")&&(n+='<div class="summary">'+e.attr("summary")+"</div>"),n+="</div>",n+='<div class="rightColumn">',n+='<div id="children"><ul></ul></div>',e.attr("theme")&&(n+='<div id="theme" data-src="'+this.getServerUrl()+e.attr("theme")+'"></div>'),n+="</div>";break;case"episode":n+='<div class="leftColumn">',n+='<div class="cover" style="background-image: url(\''+this.getTranscodedPath(e.attr("thumb"),380,256)+"')\"></div>",n+='<div class="media">',i.attr("videoResolution")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("videoResolution",i.attr("videoResolution"),100,20)+'"/>'),i.attr("audioCodec")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("audioCodec",i.attr("audioCodec"),100,20)+'"/>'),i.attr("audioChannels")&&(n+='<img src="'+this.getTranscodedMediaFlagPath("audioChannels",i.attr("audioChannels"),100,20)+'"/>'),n+="</div>",n+="</div>",n+='<div class="rightColumn">',n+='<div class="title">'+e.attr("title")+"</div>",n+='<div class="time">',e.attr("duration")&&(n+='<span class="duration">'+this.getTimeFromMS(e.attr("duration")),n+=this.getWatchedIconHtml(e.attr("lastViewedAt"),e.attr("viewOffset"),e.attr("viewCount"),e.attr("duration")),n+="</span>"),e.attr("year")&&(n+='<span class="year">'+e.attr("year")+"</span>"),n+="</div>",e.attr("summary")&&(n+='<div class="summary">'+e.attr("summary")+"</div>"),e.find("Genre").length>0&&(n+='<div class="genre">'+this.getAttributeList(e.find("Genre"),"tag",", ")+"</div>"),e.find("Role").length>0&&(n+='<div class="roles">'+this.getAttributeList(e.find("Role"),"tag",", ")+"</div>"),e.find("Writer").length>0&&(n+='<div class="writer">'+this.getAttributeList(e.find("Writer"),"tag",", ")+"</div>"),e.find("Director").length>0&&(n+='<div class="director">'+this.getAttributeList(e.find("Director"),"tag",", ")+"</div>"),r.length>0&&(n+='<div class="audio">'+(r.attr("language")||"Unknown")+" ("+r.attr("codec")+")</div>"),s.length>0&&(n+=1==s.length?'<div class="subtitles">'+s.attr("language")+" ("+s.attr("format")+")</div>":'<div class="subtitles">Disabled</div>'),i.attr("width")&&(n+='<div class="resolution">'+i.attr("width")+"x"+i.attr("height")+"</div>"),n+="</div>"}return n+="</div>"},PLEX.prototype.getWatchedIconHtml=function(t,e,i,a){return i?'<span id="watchStatus" class=""></span>':e?e/a>.9?'<span id="watchStatus" class=""></span>':'<span id="watchStatus" class="unwatched-icon unwatched-partial-icon"></span>':'<span id="watchStatus" class="unwatched-icon unwatched-full-icon"></span>'},PLEX.prototype.getAttributeList=function(t,e,i){var a=[];return t.each(function(){a.push($(this).attr(e))}),a.join(i)},PLEX.prototype.getTimeFromMS=function(t){if(!t)return"";var i=(parseInt(t%1e3/100),parseInt(t/1e3%60)),a=parseInt(t/6e4%60),r=parseInt(t/36e5%24);return r=10>r?"0"+r:r,a=10>a?"0"+a:a,i=10>i?"0"+i:i,r+":"+a+":"+i},PLEX.prototype.getGenericTranscodeUrl=function(t,e,i){i=i||{};var a=i.offset||0,r=i.quality||7,s=i.format||"mpegts",n=i.audioCodec||"libfaac",l=i.audioBitrate||128,o=i.videoCodec||"libx264",d=i.videoBitrate||3e3,c="/video/:/transcode/generic."+s+"?";return c+="identifier="+encodeURIComponent("com.plexapp.plugins.library"),c+="&format="+s,c+="&videoCodec="+o+"&videoBitrate="+d,c+="&audioCodec="+n+"&audioBitrate="+l,c+="&size=1280x720",c+="&width=1280&height=720",c+="&quality="+r,c+="&fakeContentLength=2000000000",c+="&offset="+a,c+="&key="+encodeURIComponent("http://127.0.0.1:"+this.getServerPort()+t),c+="&url="+encodeURIComponent("http://127.0.0.1:"+this.getServerPort()+e),this.getServerUrl()+c},PLEX.prototype.getHlsTranscodeUrl=function(t,e){e=e||{};var i="http://127.0.0.1:32400"+t,a=localStorage.getItem(this.PLEX_SESSION_ID),r=e.mediaIndex||"0",s=e.partIndex||"0",n=e.protocol||"http",l=e.offset||"0",o=e.fastSeek||"1",d=e.directPlay||"0",c=e.directStream||"1",h=e.maxVideoBitrate||"3000",u=e.subtitleSize||"90",f=e.videoQuality||"100",m=e.audioBoost||"100",g=e.videoResolution||"1920x1080",v=e.burnSubtitles||"burn",p=e.copyTs||"1",y=e.acceptLanguage||"en",k="/video/:/transcode/universal/start?";return k+="path="+encodeURIComponent(i),k+="&mediaIndex="+r,k+="&partIndex="+s,k+="&protocol="+n,k+="&offset="+l,k+="&fastSeek="+o,k+="&directPlay="+d,k+="&directStream="+c,k+="&videoQuality="+f,k+="&audioBoost="+m,k+="&maxVideoBitrate="+h,k+="&subtitleSize="+u,k+="&videoResolution="+g,k+="&videoQuality="+f,k+="&session="+a,k+="&subtitles="+v,k+="&copyts="+p,k+="&Accept-Language="+y,k+="&X-Plex-Client-Identifier="+this.X_Plex_Client_Identifier,k+="&X-Plex-Product="+this.X_Plex_Product,k+="&X-Plex-Device="+this.X_Plex_Device,k+="&X-Plex-Platform="+this.X_Plex_Platform,k+="&X-Plex-Platform-Version="+this.X_Plex_Platform_Version,k+="&X-Plex-Version="+this.X_Plex_Version,k+="&X-Plex-Device-Name="+this.X_Plex_Device_Name,this.getServerUrl()+k},PLEX.prototype.getTimeline=function(t,e,i,a){$.ajax({type:"GET",url:this.getServerUrl()+"/:/timeline?time="+i+"&duration="+a+"&state="+e+"&key=%2Flibrary%2Fmetadata%2F"+t+"&ratingKey="+t,headers:{"X-Plex-Client-Identifier":this.X_Plex_Client_Identifier,"X-Plex-Product":this.X_Plex_Product,"X-Plex-Device":this.X_Plex_Device,"X-Plex-Platform":this.X_Plex_Platform,"X-Plex-Platform-Version":this.X_Plex_Platform_Version,"X-Plex-Version":this.X_Plex_Version,"X-Plex-Device-Name":this.X_Plex_Device_Name}})},PLEX.prototype.ping=function(){$.ajax({type:"GET",url:this.getServerUrl()+"/video/:/transcode/universal/ping?session="+this.X_Plex_Client_Identifier,headers:{"X-Plex-Client-Identifier":this.X_Plex_Client_Identifier,"X-Plex-Product":this.X_Plex_Product,"X-Plex-Device":this.X_Plex_Device,"X-Plex-Platform":this.X_Plex_Platform,"X-Plex-Platform-Version":this.X_Plex_Platform_Version,"X-Plex-Version":this.X_Plex_Version,"X-Plex-Device-Name":this.X_Plex_Device_Name}})},PLEX.prototype.getSessionID=function(){return Math.random().toString(16).substr(2)+Math.random().toString(16).substr(2)},PLEX.prototype.panic=function(){this.setShouldShowHiddenFiles("false"),this.removeServerUrl(),location.href="index.html",window.close()};